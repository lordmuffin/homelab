apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
# Traefik CRDs/RBAC
- https://raw.githubusercontent.com/traefik/traefik/v2.10/docs/content/reference/dynamic-configuration/kubernetes-crd-definition-v1.yml
- https://raw.githubusercontent.com/traefik/traefik/v2.10/docs/content/reference/dynamic-configuration/kubernetes-crd-rbac.yml

- services.yaml
- deployment.yaml
- ingressroutes.yaml
- dashboard.yaml
- resolver.yaml

patches:
- target:
    kind: Namespace
    name: default
  patch: |-
    - op: replace
      path: /metadata/name
      value: traefik
- target:
    kind: ClusterRoleBinding
    name: traefik-ingress-controller
  patch: |-
    - op: replace
      path: /subjects/0/namespace
      value: traefik
